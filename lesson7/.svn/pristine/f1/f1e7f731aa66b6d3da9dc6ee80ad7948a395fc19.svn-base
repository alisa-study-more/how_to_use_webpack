// JavaScript Document

$(document).ready(function(){
	commentSet();
	lineSet();
});

/* 切换 */
var isAnimating = false;
function commentSet(){
	$(".polyTabs ul li").on("tap",function(){
		
		var frontIndex = $(".polyTabs ul li.current").index();
		var thisIndex = $(this).index();
		
		if(isAnimating || thisIndex == frontIndex){
			return;
		}
		
		$(".polyTabs ul li").removeClass("current");
		$(".polyTabs ul li").eq($(this).index()).addClass("current");
		
		pageSwitch(frontIndex,thisIndex);
	});
}

/* 线条精度 */
function lineSet(){
	if (window.devicePixelRatio && devicePixelRatio >= 2) {
	
	  var testElem = document.createElement('div');
	  testElem.style.border = '.5px solid transparent';
	  document.body.appendChild(testElem);
	  if (testElem.offsetHeight == 1){
		$(".polyTabs,nav.bottomNav").css({"border-width":".5px"});
	  }
	  document.body.removeChild(testElem);
	}
}

function pageSwitch(nowP,activeP){
	
	var direction;

	if (nowP < activeP) { 
		direction = 0;
	}else{
		direction = 1;
	};

	var pageIndex = nowP;
	var lastPage = ".page-"+activeP;

	var nowPage = ".page-"+pageIndex;

	switch(direction) {
		case 0:
			outClass = 'pt-page-moveToLeft';
			inClass = 'pt-page-moveFromRight';
			break;
		case 1:
			outClass = 'pt-page-moveToRight';
			inClass = 'pt-page-moveFromLeft';
			break;
	}
	isAnimating = true;
	$(lastPage).removeClass("hide");
	
	$(nowPage).addClass(outClass);
	$(lastPage).addClass(inClass);
	
	setTimeout(function(){		
		$(nowPage).removeClass('page-current');
		$(nowPage).removeClass(outClass);
		$(nowPage).addClass("hide");
		
		$(lastPage).addClass('page-current');
		$(lastPage).removeClass(inClass);

		isAnimating = false;
	},600);

}